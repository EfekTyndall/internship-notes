### 3. Automated Screw Driving System

#### Overview

The primary goal of this project was to enhance the efficiency and precision of the truck door assembly line at Daimler Truck AG. By integrating an automated screw driving system for truck doors assembly, the initiative aimed to leverage robotic technology to increase productivity, ensure optimal assembly precision, reduce manual labor, and shift human resources towards more cognitively demanding tasks. The project was a strategic response to the need for higher throughput and consistency in the assembly process, addressing both quality control and operational efficiency.

#### Operational Workflow

The system is designed to work efficiently using a setup with two stations:

1. **Station Setup**: We start by setting up two assembly stations on each side of the robot. These stations are ready to hold the truck door parts for the screwing process.
    
2. **Working with the Robot**: Operators place a door part on a station and start the screwing process using a simple control. This way, people and the robot work together smoothly.
    
3. **Robot in Action**: Once started, the robot precisely and consistently screws the parts together, showing how well automation can work.
    
4. **Keeping Things Moving**: While the robot works on one side, the operator can get the next part ready at the other station. This keeps the work flowing without any breaks.
    
5. **Finishing Up**: After the robot finishes screwing, the completed part is removed. Then, the process starts again with a new part. This cycle keeps the assembly line moving fast and efficiently.

#### System Components

The system includes several essential components that ensure smooth operation:

- **Robot Unit - FANUC CRX10iA/L Collaborative Robot:**
    
    - **Robot Controller:** Manages the robot's movements and tasks with advanced software.
    - **Human Machine Interface (HMI):** A teach pendant provides an easy-to-use interface for programming and controlling the robot.

- **Screw Fastening and Vision System - Atlas Copco & ISRA Vision:**
    
    - **User Interface:** The Assembly Control Node (ACN) from Atlas Copco allows for easy interaction and monitoring of the system.
    - **Automation Infrastructure:** The Automation Control Box (ACB) from Atlas Copco connects all parts of the system for smooth communication.
    - **Visual Guidance:** A camera and machine vision technology from ISRA Vision helps the robot precisely place screws by analyzing images in real time.

- **Screw Delivery System:**
    
    - **Fastening Tool:** Includes a screw driving spindle and a feeding unit to keep the robot supplied with screws.
    - **Screw Feeder Mechanism:** The feeding unit utilizes air pressure to transport screws through a tube directly to the spindle, ensuring a consistent and uninterrupted supply of screws for the fastening process.

- **Safety Mechanism:**
    
    - **Monitoring System:** Safety is managed by Programmable Logic Controllers (PLCs) and sensors to ensure a safe environment for operators.

- **Assembly Stations:**
    
    - **Station Setup:** Two assembly stations are designed to hold the left and right-hand door components securely in place.
    - **Holding Mechanism:** Each station has a lever equipped with a small holder for securing the part that needs to be attached to the door during the screwing process.
    - **Pneumatic Cylinder:** A pneumatic cylinder is used to open and close the lever, ensuring the components are held firmly during the screwing operation.
    - **Directional Valve:** A solenoid valve is utilized to meticulously control the pneumatic cylinder's retraction and extension.

Both the left and right side assembly stations are equipped with door components. Essential tools, including the screwing spindle and ISRA Vision camera, are securely mounted onto the robot flange. The ACN and teach pendant are fixed on the robot base fixture for easy access and system monitoring. 

#### Tool Coordinate System (Tool Frame) Calibration

Setting up the too coordinate system, or "Tool Frame," is essential for robotic operations, particularly for tasks that require high precision, such as screw driving or positioning with a camera. The Tool Frame defines how the robot's tool interacts with the environment, ensuring accuracy in movement and operation.

The Tool Frame dictates the tool's movement and rotation in three-dimensional space, critical for tasks requiring exact precision. It establishes a Cartesian coordinate system centered around the Tool Center Point (TCP), allowing for precise tool positioning and orientation relative to the robot. With the TCP as a defined 'zero point,' the robot achieves consistent performance in tasks that demand precise movements. The ability to adjust and define multiple tool frames enhances the robot's versatility, allowing for quick tool changes and diverse task execution.

##### Calibration Technique: The "Three Point Method"

The "Three Point Method" is a reliable technique for calibrating the tool frame, especially useful when the exact coordinates of the TCP are unknown. This method is instrumental for setting up tool frames for diverse tools like the screw driving spindle and camera.

**Procedure**:

1. **Interpolation Points**: The robot's tool is moved to three specific points within its working area. These points act as references to determine the TCP's position.
2. **Orientation Consistency**: This method focuses on the TCP's position, keeping the tool's orientation unchanged and consistent with the robot's design.
3. **Measuring Device and Tip**: A fixed measuring device within the robot's reach and a measuring tip on the tool, representing the TCP, are required. For the spindle, the tip of the spindle acts as the TCP; for the camera, the TCP is centrally located within the camera's field.
4. **Calibration Process**: Manually guide the robot to the three points, recording its position at each to define the TCP's spatial location relative to the robot's base.

**Using the Teach Pendant for Calibration**:

- Access Tool Frame settings via the teach pendant, navigating through MENU > SETUP > Frames > [OTHER] > Tool Frame.
- Choose a free entry (e.g., Tool Frame 3 for the spindle, Tool Frame 4 for the camera) and select DETAIL.
- Initiate the Three Point Method by selecting [METHOD] > Three Point.
- Precisely align the TCP with the tip of measuring device at the first approach point and save the position by holding SHIFT and press RECORD.
- Repeat the process for the other two points, ensuring varied orientations to accurately define the TCP.

The calibration process hinges on the precision of aligning the TCP with the measuring device at all interpolation points, ensuring varied orientations to maximize accuracy. Upon completion, the system calculates the new tool coordinate system, displaying the coordinates for x, y, and z if done correctly.

#### User Defined Coordinate System (User Frame) Calibration

Configuring User Frames is crucial for customizing how a robot interacts with different parts of its workspace. These frames allow the robot's spatial references to be tailored for specific tasks, making its operations more adaptable and efficient.

User Frames enable the customization of spatial references, aligning the robot's operations with specific workspace areas or tasks. The ability to define multiple User Frames enhances the robot's flexibility, allowing it to switch between tasks or tool configurations effortlessly. In programming, User Frames serve as the reference for all positional data, ensuring consistent robot movements relative to the defined workspace setup. User Frames facilitate easy adjustments to changes in the workspace, such as repositioned fixtures, by allowing quick recalibration to the established frames.

For this project, configuring User Frames for the left and right-hand assembly stations is vital for precise alignment with the operational environment.

##### Calibration Technique: The "Three Point Method"

The "Three Point Method" is used to define the position and orientation of User Frames by specifying three reference points on each assembly station.

**Procedure**:

1. **Selecting Interpolation Points**: Manually guide the robot to three specific locations on each fixture, chosen to provide a comprehensive spatial overview.
2. **Recording Points**: Utilize a measuring tip corresponding to a calibrated Tool Frame to precisely record the three points on the fixture.
3. **Calculating User Frames**: The robot's control system uses these points to calculate the User Frame's orientation and position relative to the base or 'WORLD' coordinate system.

**Configuring User Frames Using the Teach Pendant**:

- Ensure the correct Tool Frame is active for the measuring tip (Tool Frame 4 for the screw driving spindle).
- Navigate to User Frame settings via the teach pendant (MENU > SETUP > Frames > [OTHER] > User Frame).
- Select a free entry (User Frame 40 for the left station, User Frame 45 for the right station) and click DETAIL.
- Initiate the Three Point Method (Click [METHOD] > Three Point).

**Recording Interpolation Points**:

- **Orient Origin Point**: Define the origin of the User Frame by moving the robot so the measuring tip aligns with the desired origin point on the fixture and save the position.
- **X Direction Point**: Move the measuring tip approximately 200 mm in the desired x-axis direction from the origin point and save the position.
- **Y Direction Point**: Starting from the origin or current robot position, move the tip approximately 200 mm in the desired y-axis direction and save the position.

The "Orient Origin Point" establishes the zero point of the User Frame, with the subsequent points defining the positive directions for the x and y axes. This method ensures the robot's workspace is accurately mapped to the physical environment of the assembly stations, enhancing task precision and efficiency.

#### Point Teaching

Following the calibration of the tool and user frames, we proceed to a crucial phase known as "Point Teaching." This phase involves meticulously instructing the robot on specific locations that are critical for the screwing process on the truck doors. These locations include not only the screw holes themselves but also offset points designed to prevent any potential collisions during the operation, along with other significant points that facilitate the process.

###### Teaching Process:

1. **Identification of Screw Holes**: The initial step requires manually guiding the robot's screw driving spindle to the general vicinity of each screw hole on the truck doors. This step does not demand pinpoint accuracy but rather a close approximation of the location.
    
2. **Saving Position Registers**: Once the spindle is positioned near a screw hole, this location is saved within the robot's system as a "position register." This digital bookmarking of positions simplifies the programming phase, allowing for effortless navigation of the robot to these predefined spots by referencing the corresponding position register.
    
3. **Incorporating Offset Points**: To ensure the robot's operation is not only efficient but also safe, offset points are established. These points are strategically placed to guide the robot's path, avoiding any potential collisions with the truck door or other parts of the assembly station.
    
4. **Utilization of Other Relevant Points**: Besides the screw holes and offset points, additional locations pivotal to the screwing process are identified and taught to the robot. These might include starting positions, resting points, or specific paths the robot needs to follow during its operation.

During the Point Teaching phase, the exact precision of the screw holes' locations is not the primary focus. This is because the ISRA Vision System plays a critical role in dynamically identifying and adjusting to the precise positions of the screw holes. By integrating the vision system's feedback, the robot can autonomously correct any deviations from the initially taught positions, ensuring each screw is accurately placed regardless of minor variances in the door's positioning or the screw holes themselves.

When teaching and saving positions in position registers, it's crucial to remember that the saved positions are relative to the currently active tool and user frames. Therefore, ensuring the correct tool and user frames are activated during this process is essential.

##### Left Hand Side Door Points

For the left-hand side door, points are taught with respect to Tool Frame 4 (the screw driving spindle) and User Frame 40 (left assembly station).

- **PR[11] - PR[18]**: Positions for screw locations on the left-hand door are stored from PR[11] to PR[18], each corresponding to a specific screw, labeled Screw_11_LH through Screw_18_LH.
- **PR[2] = Offset_Z_PR18lh**: An offset point, saved as PR[2], provides necessary spatial clearance to avoid collisions, particularly between screws 17 and 18 on the left-hand side.

##### Right Hand Side Door Points

Similarly, for the right-hand side door, points are set in relation to Tool Frame 4 and User Frame 45 (right assembly station).

- **PR[21] - PR[28]**: Positions for screw locations on the right-hand door are saved from PR[21] to PR[28], each denoted for a specific screw, labeled Screw_11_RH through Screw_18_RH.
- **PR[1] = Offset_Z_PR18rh**: An offset point, stored as PR[1], ensures safe navigation between screws 17 and 18 on the right-hand side to prevent collisions.

##### Additional Points

- **PR[5] = calib_plate_1.1**: This point is designated as a reference for the calibration plate's coordinate system, located at point 1.1, and is recorded with respect to Tool Frame 4 and User Frame 0 (world coordinate).

#### ISRA Vision System

The ISRA Vision System plays a critical role in dynamically identifying and adjusting to the precise positions of the screw holes. The camera takes a picture before each screwing operation and calculates the distance between the TCP and the hole. By integrating the vision system's feedback, the robot can autonomously correct any deviations from the initially taught positions, ensuring each screw is accurately placed regardless of minor variances in the door's positioning or the screw holes themselves.

The camera is flange-mounted on the mounting plate next to the spindle. Before use, the camera must be calibrated using the ACN. The photogrammetric method is used for calibration, whereby the camera takes images of a pattern with known dimensions. The camera detects the screwing points by recognizing the hole contour. The position of the hole is then calculated and sent to the robot controller (absolute or relative to TCP).

The vision system needs to be taught to recognize each screwing holes contours. To do that each image of the screwing holes and its contours are saved as a "Product" in the ISRA Vision System. 

The position data from the vision system is received in the robot controller and the coordinates are stored in a position register for applications in the program. If the values received are a correction of the TCP, the robot should move to the coordinates as an offset from the target position. For each screwing operation, the robot first moves to the image acquisition position (the ones that is recorded during point teaching) and takes an image for approximately one second. The calculated correction values according to the tool coordinate system (x and y values) are added to the target position of the screw connection. The robot then moves into the new position and finally in the positive tool Z-direction in order to screw.

#### My Tasks:
1. **Connect the robot and utilized components to the network:**
	- Manage the networking solution for the robot so it can communicate with other components in the local network.
2. **Pneumatic system installation:**
	- Install the pneumatic parts like, valves, cables, etc. for the screw feeder, tightening spindle and levers (for each fixture), which utilizing pneumatic drive.
3. **Program the robot using the robot native interface (teach pendant):**
	- Tool Frame Calibration:
		- Calibrate tool frames for the camera and tightening spindle, which are installed on the tool flange of the robot.
		- Tool Frame 3 configured for the ISRA Vision Camera
		- Tool Frame 4 configured for the Screwing Spindle
	- User Frame Calibration:
		- To ensure the robot operates seamlessly within its environment, calibrating user frames is a critical step. This involves defining the spatial relationships between the robot and key components in its workspace.
		- User Frame 40: Configured for the left fixture, to align operation on the left hand door.
		- User Frame 44: Configured for the camera calibration plate, which located on the right fixture.
		- User Frame 45: Configured for the right fixture, to align operation on the right hand door.
		- All user frames are calibrated in reference to Tool Frame 4 (the screwing spindle), employing the three-point method. The specific points utilized for this method are clearly marked on both fixtures, with an additional reference point (point 1.1) located on the calibration plate.
	- Teaching Points:
		- Teaching the robot specific points for each screwing holes on both truck doors. Additionally, including offset points for collision avoidance informs the robot of critical areas to navigate carefully, significantly reducing the risk of collisions and ensuring operational safety.
		- For the left hand side door, the points are recorded in relation to Tool Frame 4 (the screwing spindle) and User Frame 40 (left fixture). The designated points are each saved on the robot controller as a position register (PR).
		- For the right hand side door, the points are recorded in relation to Tool Frame 4 (the screwing spindle) and User Frame 45 (right fixture). The designated points are each saved on the robot controller as a position register (PR).
	- Update the Teach Pendant Programs:
		- Update the existing teach pendant program so it can run seamlessly with the new calibrated frames and taught points.
		- Edit and optimize the program so the process can be executed more efficient.
4. **Setting up the detection system from ISRA Vision:**
	- The setup of the ISRA Vision System is a critical component in ensuring the precision of the automated screw fastening process. This section outlines the steps to configure the system through the Assembly Control Node (ACN).
	- Calibrate the sensor using the calibration plate.
	- Training and fine tuning the ISRA Vision system: To enable the ISRA Vision System to accurately identify and locate each screwing point on the truck doors, new products corresponding to these points need to be added to the system and then fine-tuned its setting for optimal performance.
5. **Writing documentation about the project and how to guides**